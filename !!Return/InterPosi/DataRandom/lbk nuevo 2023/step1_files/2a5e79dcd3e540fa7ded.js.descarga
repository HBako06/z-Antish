(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{1130:function(e,t,r){"use strict";var n=r(746);r.n(n).a},1376:function(e,t,r){"use strict";r.r(t);var n=r(744).a,o=(r(1130),r(2)),component=Object(o.a)(n,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"container request n1"},[r("div",{staticClass:"main-form"},["one"!==e.activeStep?r("lateral-card",{attrs:{structure:e.currentStructure.step_amount,step:"two"===e.activeStep,"info-broker":e.infoBroker},on:{handleChange:e.handleChange}}):e._e(),e._v(" "),"two"===e.activeStep?[r("personal-card",{directives:[{name:"show",rawName:"v-show",value:e.showpanelOne,expression:"showpanelOne"}],attrs:{listReasons:e.listReasons,structure:e.currentStructure.step_one},on:{handleChange:e.handleChange}},[r("template",{slot:"buttons"},[r("button",{staticClass:"btn-next btn-primary-default",staticStyle:{margin:"30px auto"},attrs:{"data-gtm-name":"Siguiente","data-gtm-category":"Solicitud","data-gtm-action":"Ir datos propiedad","data-gtm-label":"Siguiente"},on:{click:function(t){e.checkStructure("one"),e.scrollToTop()}}},[e._v("\n              Siguiente\n            ")]),e._v(" "),r("div",[r("nuxt-link",{staticClass:"btn-back",attrs:{to:"/prestamos"}},[r("i",{staticClass:"fas fa-chevron-left"}),e._v(" Volver")])],1),e._v(" "),r("Loading")],1)],2)]:e._e()],2),e._v(" "),r("loader",{directives:[{name:"show",rawName:"v-show",value:e.generalLoader,expression:"generalLoader"}]})],1)},[],!1,null,"4d7479da",null);t.default=component.exports},744:function(e,t,r){"use strict";(function(e){r(27),r(17),r(13),r(10),r(6),r(14),r(21);var n,o,c,l,m,d,h,_,v=r(4),f=r(9),k=r(11),y=r(924),S=r(5),w=r(550),O=r(939),x=r(473),j=r(120),R=r(304),D=r(130),I=r(38),$=r.n(I),N=r(22);function P(object,e){var t=Object.keys(object);return Object.getOwnPropertySymbols&&t.push.apply(t,Object.getOwnPropertySymbols(object)),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable})),t}function T(e){for(var i=1;i<arguments.length;i++)if(i%2){var source=null!=arguments[i]?arguments[i]:{};P(source,!0).forEach(function(t){Object(f.a)(e,t,source[t])})}else Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(arguments[i])):P(source).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(arguments[i],t))});return e}"TRUE"===e.env.IF_PRODUCTION&&r(456),r(435),t.a={layout:"layout_request",data:function(){return{listReasons:[],generalLoader:!1,activeStep:"two",showpanelOne:!0,currentStructure:{},services:{apartment:"/public/ubigeo/cities/172",province:"/public/ubigeo/province/",district:"/public/ubigeo/district/",estate:"/public/ownership",owner:"/public/owner",track:"/public/track",hill:"/public/hill",insert:"/public/request/businessman"},save_status:!1,request_counter:0,infoBroker:{},utms:{}}},asyncData:(_=Object(v.a)(regeneratorRuntime.mark(function e(t){var r,n,o,c,l,m,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.route,t.req,n=t.store,o=t.redirect,c=n.state,l=c.token,m=c.user,l&&"ce"===m.document.type&&o("/app/empresario/solicitar"),11==n.getters.sessionDocumentNumber.length&&o("/app/inversionista/oportunidades"),d={amount:r.query.monto},Object.keys(d).forEach(function(e){if(d[e])switch(e){case"amount":d[e]="NaN"===String(parseInt(d[e]))||parseInt(d[e])<2e4||parseInt(d[e])>1e6?"20000":d[e]}else switch(e){case"amount":d[e]="20000"}}),e.abrupt("return",{params:d});case 7:case"end":return e.stop()}},e)})),function(e){return _.apply(this,arguments)}),components:{"lateral-card":O.a,"personal-card":w.a,loader:x.a,Loading:D.a},mounted:function(){this.firstLoad(),this.getDataReasons()},computed:T({},Object(k.c)(["getToken","sessionEmail","sessionPhone","sessionDocumentNumber"])),methods:{getBroker:function(e){var t=this;S.c.get("/public/secured-loan/broker/"+e).then(function(r){var n=r.data.data;null!=n?(t.infoBroker=n,localStorage.broker_id=e):localStorage.removeItem("broker_id")}).catch(function(e){localStorage.removeItem("broker_id")})},getDataReasons:(h=Object(v.a)(regeneratorRuntime.mark(function e(){var t,r,data;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this).listReferentialZones=[],e.prev=2,e.next=5,S.c.get("/public/loan-reason");case 5:r=e.sent,data=r.data,data.data.map(function(e){t.listReasons.push({value:e._id,label:e.name})}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0);case 14:return e.prev=14,t.$store.commit("setHideLoading"),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[2,11,14,17]])})),function(){return h.apply(this,arguments)}),firstLoad:(d=Object(v.a)(regeneratorRuntime.mark(function e(){var t,r,n,o,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.$route.query,r=t.utm_campaign,n=t.utm_medium,o=t.utm_source,c=t.broker,this.currentStructure=JSON.parse(JSON.stringify(y.a)),e.next=4,this.catchParamsQuery(this.params);case 4:this.evalStoreData(),c&&this.getBroker(c),this.utms=T({},r&&{utm_campaign:r},{},n&&{utm_medium:n},{},o&&{utm_source:o});case 7:case"end":return e.stop()}},e,this)})),function(){return d.apply(this,arguments)}),evalStoreData:function(){var e=this,t=e.currentStructure.step_one,r=e.$store.state.token;if(r&&(localStorage.step_one=null),localStorage.step_one&&"null"!==localStorage.step_one){var n=JSON.parse(localStorage.step_one);Object.keys(n).forEach(function(i){t[i].value=n[i],t[i].valid=""!=n[i],t[i].valid="phone_alt"==i||""!=n[i]})}else if(r){["dni","phone","email"].forEach(function(e){return t[e].valid=!0}),t.dni.value=e.sessionDocumentNumber,t.dni.disabled=!0,t.phone.value=e.sessionPhone,t.email.value=e.sessionEmail}(localStorage.form_token&&"null"!==localStorage.form_token&&"undefined"!==localStorage.form_token||e.$route.query.token)&&e.getDataIncomplete()},scrollToTop:function(){window.scrollTo(0,0)},handleChange:(m=Object(v.a)(regeneratorRuntime.mark(function e(t,r,n){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(o=this).currentStructure[r.parentkey][r.childkey].value=t.value,o.currentStructure[r.parentkey][r.childkey].valid=t.valid,o.currentStructure[r.parentkey][r.childkey].has_error=!t.valid,e.t0=r.childkey,e.next="amount"===e.t0?7:"phone_alt"===e.t0?9:11;break;case 7:return("NaN"===String(parseInt(t.value))||parseInt(t.value)<2e4)&&(o.currentStructure[r.parentkey][r.childkey].value=2e4,o.currentStructure[r.parentkey][r.childkey].valid=!0,o.currentStructure[r.parentkey][r.childkey].has_error=!1),e.abrupt("break",11);case 9:return o.currentStructure[r.parentkey][r.childkey].value?(o.currentStructure[r.parentkey][r.childkey].required=!0,o.currentStructure[r.parentkey][r.childkey].valid=!1,o.currentStructure[r.parentkey][r.childkey].has_error=!0,o.currentStructure[r.parentkey].phone_alt.value.length>=parseInt(o.currentStructure[r.parentkey].phone_alt.minLength)&&(o.currentStructure[r.parentkey][r.childkey].required=!1,o.currentStructure[r.parentkey][r.childkey].valid=!0,o.currentStructure[r.parentkey][r.childkey].has_error=!1)):(o.currentStructure[r.parentkey][r.childkey].valid=!0,o.currentStructure[r.parentkey][r.childkey].required=!1,o.currentStructure[r.parentkey][r.childkey].has_error=!1),e.abrupt("break",11);case 11:case"end":return e.stop()}},e,this)})),function(e,t,r){return m.apply(this,arguments)}),checkStructure:(l=Object(v.a)(regeneratorRuntime.mark(function e(t){var r,n,o,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="step_one",o=(r=this).currentStructure[n],c=Object(j.b)(o),r.$store.commit("setShowLoading"),!c.result){e.next=13;break}if(l={},Object.keys(o).forEach(function(i){"label"!==o[i].type&&(l[i]=o[i].value)}),r.save_status){e.next=11;break}return r.save_status=!0,e.next=9,r.saveDataIncomplete(l);case 9:r.showpanelOne=!1,localStorage.step_one=JSON.stringify(l);case 11:e.next=15;break;case 13:Object.keys(r.currentStructure[n]).forEach(function(e){r.currentStructure[n][e].disabled?r.currentStructure[n][e].has_error=!1:r.currentStructure[n][e].has_error=!r.currentStructure[n][e].valid}),r.currentStructure._rand=Math.random();case 15:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)}),saveDataIncomplete:(c=Object(v.a)(regeneratorRuntime.mark(function e(t){var r,n,o,c,data,l,m,d,h,_,v,f,k,y,w,O,x;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,e.prev=1,e.next=4,this.$recaptcha("pre_request");case 4:return n=e.sent,o=T({step:1,captcha:n,document:t.dni,email:t.email,phone:t.phone,pay:r.currentStructure.step_amount.amount.value,foreign_exchange:1,have_real_estate:t.have_real_estate,accept_terms_conditions:!0,waytopay:"",term:"",rate:"",motive_id:t.reason},localStorage.broker_id&&{broker_id:localStorage.broker_id},{},t.phone_alt&&{phone_second:t.phone_alt},{},this.utms),e.next=8,S.c.post("/public/pre-request",o);case 8:return c=e.sent,data=c.data,l=data.data,m=l.token,d=l.have_real_estate,h=l.motive,_=l.metadata,v=r.$route.query&&r.$route.query.broker||null,_&&(this.utms=_),f=T({monto:o.pay},m&&{token:m},{},v&&{broker:v},{},this.utms,{t:(new Date).getTime()}),k="?"+Object.keys(f).map(function(e){return"".concat(e,"=").concat(encodeURIComponent(f[e]))}).join("&"),m&&(localStorage.form_token=m,r.save_status=!1),y="/solicitud/datos_propiedad_1".concat(k),e.next=19,r.hubspot(o,data.data);case 19:return e.sent,e.t0=r,e.t1=T,e.t2=r.$toFixedNoRound(r.currentStructure.step_amount.amount.value,2),e.t3=h.name,e.t4=t.email,e.t5=t.dni,e.next=28,Object(R.a)(t.dni);case 28:return e.t6=e.sent,e.next=31,Object(R.a)(t.email);case 31:e.t7=e.sent,e.t8=t.phone,e.t9=t.phone_alt||null,e.t10=d?"SÃ­ tiene propiedad":"No tiene propiedad",e.t11=r.getToken?"registrado":"no registrado",e.t12=r.getToken?"logueado":"no logueado",e.t13={event:"prestamos.step1_datosPersonales",producto:"prestamos",prestamo_montoSolicitado:e.t2,prestamo_moneda:"PEN",prestamo_interesMensual:"1.35",prestamo_motivo:e.t3,user_email:e.t4,user_tipoDocumento:"DNI",user_numDocumento:e.t5,user_id:e.t6,lead_id:e.t7,user_telefono1:e.t8,user_telefono2:e.t9,user_tienePropiedad:e.t10,user_tipo:e.t11,visita_tipo:e.t12},e.t14=!d&&{resultado:"no_propiedad"},e.t15={operacion_id:m||null},e.t16=(0,e.t1)(e.t13,e.t14,e.t15),e.t0.$gDataLayer.call(e.t0,e.t16),d?r.$router.push(y):r.$router.push("/solicitud/no_propiedad?".concat(k)),e.next=49;break;case 45:e.prev=45,e.t17=e.catch(1),e.t17.response&&(w=new URL(e.t17.response.config.url),O=w.href,x=w.pathname,r.$gDataLayer({event:"prestamype.formError",error_tipo:"API error",error_endpoint:x,error_codigo:"".concat(e.t17.response.config.method," ").concat(e.t17.response.status),error_mensajeUsuario:e.t17.response.data.message,error_descripcionTecnica:O})),r.save_status=!1;case 49:case"end":return e.stop()}},e,this,[[1,45]])})),function(e){return c.apply(this,arguments)}),hubspot:(o=Object(v.a)(regeneratorRuntime.mark(function e(t,r){var n,o,c,l,data;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this,n=r.applicant,o=r.requested_amount,c=r.motive,l=r.rate_discount,data={fields:[{name:"origin_web_prestamos",value:null===localStorage.getItem("origin_web_prestamos")?"landing":localStorage.getItem("origin_web_prestamos")},{name:"tasa_de_descuento",value:l?"".concat(l,"%"):" "},{name:"correo_del_broker_referidor",value:localStorage.broker_id&&0!=Object.keys(this.infoBroker).length?this.infoBroker.email:" "},{name:"motive",value:c.name},{name:"dni",value:n.document},{name:"email",value:n.email},{name:"phone",value:n.phone},{name:"otro_telefono_de_contacto",value:"phone_second"in n?n.phone_second:""},{name:"monto",value:o},{name:"tienes_una_propiedad_que_puedas_dejar_en_garantia_",value:t.have_real_estate?"1":"2"},{name:"forma_de_pago",value:t.waytopay},{name:"plazos",value:t.term},{name:"url_email_redirect",value:localStorage.broker_id?"https://www.prestamype.com/solicitud/datos_personales_1?monto="+o+"&broker=".concat(localStorage.broker_id):"https://www.prestamype.com/solicitud/datos_personales_1?monto="+o}],context:{hutk:N.get("hubspotutk"),pageUri:"https://www.prestamype.com/solicitud/datos_personales_1",pageName:"Datos personales"}},e.next=5,$()({url:"https://api.hsforms.com/submissions/v3/integration/submit/9399757/a83d3769-c99b-42e4-9d35-92cf53a37045",method:"POST",data:data}).then(function(e){}).catch(function(e){return console.log("error",e)});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)})),function(e,t){return o.apply(this,arguments)}),getDataIncomplete:(n=Object(v.a)(regeneratorRuntime.mark(function e(){var t,r,n,data,o,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(t=this).currentStructure.step_one,e.prev=1,e.next=4,S.c.get("/public/pre-request/".concat(t.$route.query.token||localStorage.form_token));case 4:if(n=e.sent,data=n.data,o=data.data,c="/solicitud/datos_personales_1",null!=o){e.next=11;break}return localStorage.removeItem("form_token"),e.abrupt("return");case 11:return o.metadata&&(this.utms=o.metadata),e.next=14,t.catchParamsQuery({amount:o.requested_amount});case 14:localStorage.form_token=o.token,t.$router.push({path:c,query:T({monto:o.requested_amount,token:t.$route.query.token||localStorage.form_token,t:(new Date).getTime()},t.$route.query.broker&&{broker:t.$route.query.broker},{},this.utms)}),t.getToken||(r.dni.value=o.applicant.document,r.dni.valid=""!=o.applicant.document),r.phone.value=o.applicant.phone,r.phone.valid=""!=o.applicant.phone,r.phone_alt.value=o.applicant.phone_second,r.phone_alt.valid=!0,r.email.value=o.applicant.email,r.email.valid=""!=o.applicant.email,r.have_real_estate.value=o.have_real_estate,r.have_real_estate.valid="have_real_estate"in o,r.aceptTerms.value=o.accept_terms_conditions||!1,r.aceptTerms.valid="accept_terms_conditions"in o,r.reason.value=o.motive._id,r.reason.valid=""!=o.motive._id,e.next=34;break;case 31:e.prev=31,e.t0=e.catch(1),e.t0.response&&"AutenticaciÃ³n fallida"==e.t0.response.data.message&&(localStorage.removeItem("form_token"),t.$router.push("/prestamos"));case 34:case"end":return e.stop()}},e,this,[[1,31]])})),function(){return n.apply(this,arguments)}),catchParamsQuery:function(e){var t=this;Object.keys(e).forEach(function(r){"amount"==r&&(t.currentStructure.step_amount[r].value=e[r])})}}}}).call(this,r(124))},746:function(e,t,r){}}]);